generator client { provider = "prisma-client-js" }
datasource db { provider = "sqlite"; url = env("DATABASE_URL") }

model Service {
  id          String   @id @default(cuid())
  name        String   @unique
  durationMin Int
  priceCents  Int
  active      Boolean  @default(true)
  Appointment Appointment[]
}

model Barber {
  id           String   @id @default(cuid())
  displayName  String
  color        String   @default("#C7A47D")
  WorkingHours WorkingHours[]
  TimeOff      TimeOff[]
  Appointment  Appointment[]
}

model Appointment {
  id            String   @id @default(cuid())
  serviceId     String
  barberId      String
  customerName  String
  customerEmail String
  customerPhone String?
  start         DateTime
  end           DateTime
  status        Status   @default(BOOKED)

  service Service @relation(fields: [serviceId], references: [id])
  barber  Barber  @relation(fields: [barberId], references: [id])

  @@index([barberId, start])
}

model WorkingHours {
  id       String  @id @default(cuid())
  barberId String
  weekday  Int      // 0 = Sun â€¦ 6 = Sat
  opens    String   // "09:00"
  closes   String   // "18:00"
  barber   Barber   @relation(fields: [barberId], references: [id])
}

model TimeOff {
  id       String  @id @default(cuid())
  barberId String
  start    DateTime
  end      DateTime
  reason   String?
  barber   Barber  @relation(fields: [barberId], references: [id])
}

enum Status { BOOKED CONFIRMED COMPLETED NO_SHOW CANCELLED }
